<div class="container">
  <div class="actions-section">
    <button (click)="addProduct()">Add</button>
    <div class="search-container">
      <input type="text" placeholder="Search products..."
      [(ngModel)]="searchTerm"
      (input)="onSearch()"
      class="search-input">
    <button
      type="button"
      (click)="clearSearch()"
      class="clear-button"
      [disabled]="!searchTerm">
      Clear
    </button>
    </div>

    <h3>Sort by:</h3>
    <select name="sort" [(ngModel)]="sortBy" (change)="onSortChange()">
      <option value="">None</option>
      <option value="name">Name</option>
      <option value="dateCreated">Recently added</option>
    </select>
  </div>
  <div class="products-container">
    <div class="products-list">
      @for (item of paginatedProducts | async; track item.id) {
        <div class="product" [ngClass]="{'active': item.id === selectedItem}" (click)="showDetails(item.id)">
          @if (item.image !== '') {
            <img src="{{item.image}}" alt="">
          }
          @else {
            <img src="https://placehold.co/150" alt="">
          }
          <div class="product-details">
            <div class="product-summary">
              <h3>{{item.name}}</h3>
              <div>{{item.description}}</div>
              <div><strong>Created at:</strong> {{item.creationDate | date:'short' }}</div>
            </div>
            <button (click)="deleteProduct(item.id); $event.stopPropagation()">Delete</button>
          </div>
        </div>
      }

      <!-- Pagination Controls -->
      @if (totalPages > 1) {
        <div class="pagination-container">
          <div class="pagination-info">
            Showing page {{ currentPage }} of {{ totalPages }} pages
          </div>

          <div class="pagination-controls">
            <button
              class="pagination-btn"
              (click)="previousPage()"
              [disabled]="currentPage === 1">
              Previous
            </button>

            <button
              class="pagination-btn"
              (click)="nextPage()"
              [disabled]="currentPage === totalPages">
              Next
            </button>
          </div>
        </div>
      }
    </div>
    <div class="product-view">
      <router-outlet></router-outlet>
    </div>
  </div>

  @if (showDeleteModal) {
    <div class="modal-overlay" (click)="closeDeleteModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <h3>Delete Product</h3>
        <p>Are you sure you want to delete this product?</p>
        <div class="modal-actions">
          <button class="cancel-btn" (click)="closeDeleteModal()">Cancel</button>
          <button class="delete-btn" (click)="confirmDelete()">Delete</button>
        </div>
      </div>
    </div>
  }
</div>
